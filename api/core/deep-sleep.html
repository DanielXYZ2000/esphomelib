<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><meta http-equiv="X-UA-Compatible"content="IE=Edge"><meta http-equiv="Content-Type"content="text/html; charset=utf-8"><title>Deep Sleep &#8212; esphomelib 1.3.0 documentation</title><link rel="stylesheet"href="../../_static/alabaster.css"type="text/css"><link rel="stylesheet"href="../../_static/pygments.css"type="text/css"><script src="../../_static/documentation_options.js"></script><script src="../../_static/jquery.js"></script><script src="../../_static/underscore.js"></script><script src="../../_static/doctools.js"></script><link rel="index"title="Index"href="../../genindex.html"><link rel="search"title="Search"href="../../search.html"><link rel="next"title="Sensor"href="../sensor/index.html"><link rel="prev"title="Web Server"href="web-server.html"><link rel="stylesheet"href="../../_static/custom.css"type="text/css"><meta name="viewport"content="width=device-width,initial-scale=0.9,maximum-scale=0.9"><div class="document"><div class="documentwrapper"><div class="bodywrapper"><div class="body"role="main"><div class="section"id="deep-sleep"><h1>Deep Sleep<a class="headerlink"href="#deep-sleep"title="Permalink to this headline">¶</a></h1><div class="section"id="api-reference"><h2>API Reference<a class="headerlink"href="#api-reference"title="Permalink to this headline">¶</a></h2><div class="section"id="deepsleepcomponent"><h3>DeepSleepComponent<a class="headerlink"href="#deepsleepcomponent"title="Permalink to this headline">¶</a></h3><dl class="class"><dt id="_CPPv3N10esphomelib18DeepSleepComponentE"><span id="_CPPv2N10esphomelib18DeepSleepComponentE"></span><span id="esphomelib::DeepSleepComponent"></span><span class="target"id="classesphomelib_1_1_deep_sleep_component"></span><em class="property">class </em>esphomelib<code class="descclassname">::</code><code class="descname">DeepSleepComponent</code><a class="headerlink"href="#_CPPv3N10esphomelib18DeepSleepComponentE"title="Permalink to this definition">¶</a><br><dd><p>This component allows setting up the node to go into deep sleep mode to conserve battery.<p>To set this component up, first set <em>when</em> the deep sleep should trigger using set_run_cycles and set_run_duration, then set how long the deep sleep should last using set_sleep_duration and optionally on the ESP32 set_wakeup_pin.<p>Inherits from <a class="reference internal"href="controller.html#classesphomelib_1_1_component"><span class="std std-ref">esphomelib::Component</span></a><div class="breathe-sectiondef docutils container"><p class="breathe-sectiondef-title rubric">Public Functions<dl class="function"><dt id="_CPPv3N10esphomelib18DeepSleepComponent18set_sleep_durationE8uint32_t"><span id="_CPPv2N10esphomelib18DeepSleepComponent18set_sleep_durationE8uint32_t"></span><span id="esphomelib::DeepSleepComponent::set_sleep_duration__uint32_t"></span><span class="target"id="classesphomelib_1_1_deep_sleep_component_1aa54cf91db9043c7f00d3bbaa3f7035b1"></span>void esphomelib::<a class="reference internal"href="#_CPPv3N10esphomelib18DeepSleepComponentE"title="esphomelib::DeepSleepComponent">DeepSleepComponent</a><code class="descname">set_sleep_duration</code><span class="sig-paren">(</span>uint32_t <em>time_ms</em><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N10esphomelib18DeepSleepComponent18set_sleep_durationE8uint32_t"title="Permalink to this definition">¶</a><br><dd><p>Set the duration in ms the component should sleep once it’s in deep sleep mode.</dl><dl class="function"><dt id="_CPPv3N10esphomelib18DeepSleepComponent14set_wakeup_pinE12GPIOInputPin"><span id="_CPPv2N10esphomelib18DeepSleepComponent14set_wakeup_pinE12GPIOInputPin"></span><span id="esphomelib::DeepSleepComponent::set_wakeup_pin__GPIOInputPin"></span><span class="target"id="classesphomelib_1_1_deep_sleep_component_1a83bf9f0c8b1f001f36e34299c0542ea8"></span>void esphomelib::<a class="reference internal"href="#_CPPv3N10esphomelib18DeepSleepComponentE"title="esphomelib::DeepSleepComponent">DeepSleepComponent</a><code class="descname">set_wakeup_pin</code><span class="sig-paren">(</span><a class="reference internal"href="helpers.html#_CPPv3N10esphomelib12GPIOInputPinE"title="esphomelib::GPIOInputPin">GPIOInputPin</a> <em>pin</em><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N10esphomelib18DeepSleepComponent14set_wakeup_pinE12GPIOInputPin"title="Permalink to this definition">¶</a><br><dd><p>Set the pin to wake up to on the ESP32 once it’s in deep sleep mode.<p>Use the inverted property to set the wakeup level.</dl><dl class="function"><dt id="_CPPv3N10esphomelib18DeepSleepComponent14set_run_cyclesE8uint32_t"><span id="_CPPv2N10esphomelib18DeepSleepComponent14set_run_cyclesE8uint32_t"></span><span id="esphomelib::DeepSleepComponent::set_run_cycles__uint32_t"></span><span class="target"id="classesphomelib_1_1_deep_sleep_component_1a875666c2b9eaa0fe5d5260beff9c8ee6"></span>void esphomelib::<a class="reference internal"href="#_CPPv3N10esphomelib18DeepSleepComponentE"title="esphomelib::DeepSleepComponent">DeepSleepComponent</a><code class="descname">set_run_cycles</code><span class="sig-paren">(</span>uint32_t <em>cycles</em><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N10esphomelib18DeepSleepComponent14set_run_cyclesE8uint32_t"title="Permalink to this definition">¶</a><br><dd><p>Set the number of loop cycles after which the node should go into deep sleep mode.</dl><dl class="function"><dt id="_CPPv3N10esphomelib18DeepSleepComponent16set_run_durationE8uint32_t"><span id="_CPPv2N10esphomelib18DeepSleepComponent16set_run_durationE8uint32_t"></span><span id="esphomelib::DeepSleepComponent::set_run_duration__uint32_t"></span><span class="target"id="classesphomelib_1_1_deep_sleep_component_1a826673facdb23802e78fd59c1f692d3c"></span>void esphomelib::<a class="reference internal"href="#_CPPv3N10esphomelib18DeepSleepComponentE"title="esphomelib::DeepSleepComponent">DeepSleepComponent</a><code class="descname">set_run_duration</code><span class="sig-paren">(</span>uint32_t <em>time_ms</em><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N10esphomelib18DeepSleepComponent16set_run_durationE8uint32_t"title="Permalink to this definition">¶</a><br><dd><p>Set a duration in ms for how long the code should run before entering deep sleep mode.</dl><dl class="function"><dt id="_CPPv3N10esphomelib18DeepSleepComponent5setupEv"><span id="_CPPv2N10esphomelib18DeepSleepComponent5setupEv"></span><span id="esphomelib::DeepSleepComponent::setup"></span><span class="target"id="classesphomelib_1_1_deep_sleep_component_1a0d44355960d46515ceef627a6a416c0b"></span>void esphomelib::<a class="reference internal"href="#_CPPv3N10esphomelib18DeepSleepComponentE"title="esphomelib::DeepSleepComponent">DeepSleepComponent</a><code class="descname">setup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N10esphomelib18DeepSleepComponent5setupEv"title="Permalink to this definition">¶</a><br><dd><p>Where the component’s initialization should happen.<p>Analogous to Arduino’s <a class="reference internal"href="#classesphomelib_1_1_deep_sleep_component_1a0d44355960d46515ceef627a6a416c0b"><span class="std std-ref">setup()</span></a>. This method is guaranteed to only be called once. Defaults to doing noting.</dl><dl class="function"><dt id="_CPPv3N10esphomelib18DeepSleepComponent4loopEv"><span id="_CPPv2N10esphomelib18DeepSleepComponent4loopEv"></span><span id="esphomelib::DeepSleepComponent::loop"></span><span class="target"id="classesphomelib_1_1_deep_sleep_component_1a108c0cac4000159ab4ee0237e97426aa"></span>void esphomelib::<a class="reference internal"href="#_CPPv3N10esphomelib18DeepSleepComponentE"title="esphomelib::DeepSleepComponent">DeepSleepComponent</a><code class="descname">loop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N10esphomelib18DeepSleepComponent4loopEv"title="Permalink to this definition">¶</a><br><dd><p>This method will be called repeatedly.<p>Analogous to Arduino’s <a class="reference internal"href="#classesphomelib_1_1_deep_sleep_component_1a108c0cac4000159ab4ee0237e97426aa"><span class="std std-ref">loop()</span></a>. <a class="reference internal"href="#classesphomelib_1_1_deep_sleep_component_1a0d44355960d46515ceef627a6a416c0b"><span class="std std-ref">setup()</span></a> is guaranteed to be called before this. Defaults to doing nothing.</dl><dl class="function"><dt id="_CPPv3NK10esphomelib18DeepSleepComponent17get_loop_priorityEv"><span id="_CPPv2NK10esphomelib18DeepSleepComponent17get_loop_priorityEv"></span><span id="esphomelib::DeepSleepComponent::get_loop_priorityC"></span><span class="target"id="classesphomelib_1_1_deep_sleep_component_1a972d673dc19a4631e7ae1a5959cde55b"></span>float esphomelib::<a class="reference internal"href="#_CPPv3N10esphomelib18DeepSleepComponentE"title="esphomelib::DeepSleepComponent">DeepSleepComponent</a><code class="descname">get_loop_priority</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink"href="#_CPPv3NK10esphomelib18DeepSleepComponent17get_loop_priorityEv"title="Permalink to this definition">¶</a><br><dd><p>priority of <a class="reference internal"href="#classesphomelib_1_1_deep_sleep_component_1a108c0cac4000159ab4ee0237e97426aa"><span class="std std-ref">loop()</span></a>.<p>higher -&gt; executed earlier<p>Defaults to 0.<p><dl class="docutils"><dt><strong>Return</strong><dd>The loop priority of this component</dl><p></dl></div><div class="breathe-sectiondef docutils container"><p class="breathe-sectiondef-title rubric">Protected Functions<dl class="function"><dt id="_CPPv3N10esphomelib18DeepSleepComponent11begin_sleepEv"><span id="_CPPv2N10esphomelib18DeepSleepComponent11begin_sleepEv"></span><span id="esphomelib::DeepSleepComponent::begin_sleep"></span><span class="target"id="classesphomelib_1_1_deep_sleep_component_1a1d6d93618ea1b846f370e592e0b8b3fc"></span>void esphomelib::<a class="reference internal"href="#_CPPv3N10esphomelib18DeepSleepComponentE"title="esphomelib::DeepSleepComponent">DeepSleepComponent</a><code class="descname">begin_sleep</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N10esphomelib18DeepSleepComponent11begin_sleepEv"title="Permalink to this definition">¶</a><br><dd><p>Helper to enter deep sleep mode.</dl></div><div class="breathe-sectiondef docutils container"><p class="breathe-sectiondef-title rubric">Protected Attributes<dl class="member"><dt id="_CPPv3N10esphomelib18DeepSleepComponent15sleep_duration_E"><span id="_CPPv2N10esphomelib18DeepSleepComponent15sleep_duration_E"></span><span id="esphomelib::DeepSleepComponent::sleep_duration___Optional:uint64_t:"></span><span class="target"id="classesphomelib_1_1_deep_sleep_component_1a7a9066c31f41841e0c19bf58683244ce"></span><a class="reference internal"href="helpers.html#_CPPv3N10esphomelib8OptionalE"title="esphomelib::Optional">Optional</a>&lt;uint64_t&gt; esphomelib::<a class="reference internal"href="#_CPPv3N10esphomelib18DeepSleepComponentE"title="esphomelib::DeepSleepComponent">DeepSleepComponent</a><code class="descname">sleep_duration_</code> = {}<a class="headerlink"href="#_CPPv3N10esphomelib18DeepSleepComponent15sleep_duration_E"title="Permalink to this definition">¶</a><br><dd></dl><dl class="member"><dt id="_CPPv3N10esphomelib18DeepSleepComponent11wakeup_pin_E"><span id="_CPPv2N10esphomelib18DeepSleepComponent11wakeup_pin_E"></span><span id="esphomelib::DeepSleepComponent::wakeup_pin___Optional:GPIOInputPin:"></span><span class="target"id="classesphomelib_1_1_deep_sleep_component_1a5709040ee6065cd26cfa8427afaa417c"></span><a class="reference internal"href="helpers.html#_CPPv3N10esphomelib8OptionalE"title="esphomelib::Optional">Optional</a>&lt;<a class="reference internal"href="helpers.html#_CPPv3N10esphomelib12GPIOInputPinE"title="esphomelib::GPIOInputPin">GPIOInputPin</a>&gt; esphomelib::<a class="reference internal"href="#_CPPv3N10esphomelib18DeepSleepComponentE"title="esphomelib::DeepSleepComponent">DeepSleepComponent</a><code class="descname">wakeup_pin_</code> = {}<a class="headerlink"href="#_CPPv3N10esphomelib18DeepSleepComponent11wakeup_pin_E"title="Permalink to this definition">¶</a><br><dd></dl><dl class="member"><dt id="_CPPv3N10esphomelib18DeepSleepComponent12loop_cycles_E"><span id="_CPPv2N10esphomelib18DeepSleepComponent12loop_cycles_E"></span><span id="esphomelib::DeepSleepComponent::loop_cycles___Optional:uint32_t:"></span><span class="target"id="classesphomelib_1_1_deep_sleep_component_1a8dada94e0bde0321f150919b952d832a"></span><a class="reference internal"href="helpers.html#_CPPv3N10esphomelib8OptionalE"title="esphomelib::Optional">Optional</a>&lt;uint32_t&gt; esphomelib::<a class="reference internal"href="#_CPPv3N10esphomelib18DeepSleepComponentE"title="esphomelib::DeepSleepComponent">DeepSleepComponent</a><code class="descname">loop_cycles_</code> = {}<a class="headerlink"href="#_CPPv3N10esphomelib18DeepSleepComponent12loop_cycles_E"title="Permalink to this definition">¶</a><br><dd></dl><dl class="member"><dt id="_CPPv3N10esphomelib18DeepSleepComponent14at_loop_cycle_E"><span id="_CPPv2N10esphomelib18DeepSleepComponent14at_loop_cycle_E"></span><span id="esphomelib::DeepSleepComponent::at_loop_cycle___uint32_t"></span><span class="target"id="classesphomelib_1_1_deep_sleep_component_1a0d75a3a834cf2e9738e11d90755a872d"></span>uint32_t esphomelib::<a class="reference internal"href="#_CPPv3N10esphomelib18DeepSleepComponentE"title="esphomelib::DeepSleepComponent">DeepSleepComponent</a><code class="descname">at_loop_cycle_</code> = {0}<a class="headerlink"href="#_CPPv3N10esphomelib18DeepSleepComponent14at_loop_cycle_E"title="Permalink to this definition">¶</a><br><dd></dl><dl class="member"><dt id="_CPPv3N10esphomelib18DeepSleepComponent13run_duration_E"><span id="_CPPv2N10esphomelib18DeepSleepComponent13run_duration_E"></span><span id="esphomelib::DeepSleepComponent::run_duration___Optional:uint32_t:"></span><span class="target"id="classesphomelib_1_1_deep_sleep_component_1aacca332f37b1788e6d5345cf8e22cadf"></span><a class="reference internal"href="helpers.html#_CPPv3N10esphomelib8OptionalE"title="esphomelib::Optional">Optional</a>&lt;uint32_t&gt; esphomelib::<a class="reference internal"href="#_CPPv3N10esphomelib18DeepSleepComponentE"title="esphomelib::DeepSleepComponent">DeepSleepComponent</a><code class="descname">run_duration_</code> = {}<a class="headerlink"href="#_CPPv3N10esphomelib18DeepSleepComponent13run_duration_E"title="Permalink to this definition">¶</a><br><dd></dl></div></dl></div></div></div></div></div></div><div class="sphinxsidebar"role="navigation"aria-label="main navigation"><div class="sphinxsidebarwrapper"><div class="relations"><h3>Related Topics</h3><ul><li><a href="../../index.html">Documentation overview</a><ul><li><a href="../index.html">API Reference</a><ul><li><a href="index.html">Core</a><ul><li>Previous: <a href="web-server.html"title="previous chapter">Web Server</a><li>Next: <a href="../sensor/index.html"title="next chapter">Sensor</a></ul></ul></ul></ul></div><div id="searchbox"style="display: none"role="search"><h3>Quick search</h3><div class="searchformwrapper"><form class="search"action="../../search.html"><input name="q"> <input type="submit"value="Go"> <input type="hidden"name="check_keywords"value="yes"> <input type="hidden"name="area"value="default"></form></div></div><script>$('#searchbox').show(0);</script></div></div><div class="clearer"></div></div><div class="footer">&copy;2018, Otto Winter. | Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.2</a> &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a> | <a href="../../_sources/api/core/deep-sleep.rst.txt"rel="nofollow">Page source</a></div><script>var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-113203480-2']);
      _gaq.push(['_setDomainName', 'none']);
      _gaq.push(['_setAllowLinker', true]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();</script>